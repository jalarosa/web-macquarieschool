!function(){var f=$('<div id="galleryOverlay">'),s=$('<div id="gallerySlider">'),t=$('<a id="prevArrow"></a>'),n=$('<a id="nextArrow"></a>'),h=!1;$.fn.touchTouch=function(){var o=$([]),a=0,e=this,r=e;function l(t){s.css("left",100*-t+"%")}function c(t){setTimeout(function(){u(t)},1e3)}function u(t){if(t<0||t>=r.length)return!1;var e,n,i;e=r.eq(t).attr("href"),n=function(){o.eq(t).html(this)},(i=$("<img>").on("load",function(){n.call(i)})).attr("src",e)}function i(){a+1<r.length?(l(++a),c(a+1)):(s.addClass("rightSpring"),setTimeout(function(){s.removeClass("rightSpring")},500))}function d(){0<a?(l(--a),c(a-1)):(s.addClass("leftSpring"),setTimeout(function(){s.removeClass("leftSpring")},500))}f.hide().appendTo("body"),s.appendTo(f),r.each(function(){o=o.add($('<div class="placeholder">'))}),s.append(o).on("click",function(t){$(t.target).is("img")||function(){if(!h)return;f.hide().removeClass("visible"),h=!1,$(".placeholder").empty(),r=e}()}),$("body").on("touchstart","#gallerySlider img",function(t){var e=t.originalEvent,n=e.changedTouches[0].pageX;return s.on("touchmove",function(t){t.preventDefault(),10<(e=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]).pageX-n?(s.off("touchmove"),d()):e.pageX-n<-10&&(s.off("touchmove"),i())}),!1}).on("touchend",function(){s.off("touchmove")}),r.on("click",function(t){t.preventDefault();var e,n,i=$(this),o=i.parent().closest("[data-gallery]");i.attr("data-gallery")?(e=i.attr("data-gallery"),n="item"):o.length&&(e=o.attr("data-gallery"),n="ancestor"),e&&"item"==n?r=$("[data-gallery="+e+"]"):e&&"ancestor"==n&&(r=r.filter(function(){return $(this).parent().closest("[data-gallery]").length})),function(t){if(h)return;f.show(),setTimeout(function(){f.addClass("visible")},100),l(t),h=!0}(a=r.index(this)),u(a),c(a+1),c(a-1)}),"ontouchstart"in window||(f.append(t).append(n),t.click(function(t){t.preventDefault(),d()}),n.click(function(t){t.preventDefault(),i()})),$(window).bind("keydown",function(t){37==t.keyCode?d():39==t.keyCode&&i()})}}(jQuery);